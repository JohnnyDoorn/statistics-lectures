<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Klinkenberg" />


<title>Non-parametric tests</title>

<script src="non_parametric_tests_handout_files/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="non_parametric_tests_handout_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="non_parametric_tests_handout_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="non_parametric_tests_handout_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="non_parametric_tests_handout_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="non_parametric_tests_handout_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="non_parametric_tests_handout_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="non_parametric_tests_handout_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="non_parametric_tests_handout_files/navigation-1.1/tabsets.js"></script>
<link href="non_parametric_tests_handout_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="non_parametric_tests_handout_files/highlightjs-9.12.0/highlight.js"></script>
<script src="non_parametric_tests_handout_files/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="non_parametric_tests_handout_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="non_parametric_tests_handout_files/datatables-binding-0.15/datatables.js"></script>
<link href="non_parametric_tests_handout_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="non_parametric_tests_handout_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="non_parametric_tests_handout_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="non_parametric_tests_handout_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="non_parametric_tests_handout_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107432294-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-107432294-1');
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Non-parametric tests</h1>
<h4 class="author">Klinkenberg</h4>
<h4 class="date">3 oct 2020</h4>

</div>


<div id="inhoud" class="section level2">
<h2>Inhoud</h2>
<div id="toc" style="font-size:60%; text-align:left;">

</div>
<!-- Add the required topics below -->
</div>
<div id="nonparametric-tests" class="section level1 section">
<h1>Nonparametric tests</h1>
<div id="mytable" class="section level2">
<h2>Parametric vs Nonparametric</h2>
<!-- <style>
#mytable th {
background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(40%, #FFA500), color-stop(80%, #FFA500)) no-repeat !important;
background-image: -webkit-linear-gradient(top, rgb(255,165,0) 40%, rgb(255,165,0) 80%) !important;
background: -webkit-linear-gradient(top, #FFA500 40%, #FFA500 80%) no-repeat !important;
background-image: -webkit-linear-gradient(top, rgb(255,165,0) 40%, rgb(255,165,0) 80%) !important;
background: -moz-linear-gradient(top, #FFA500 40%, #FFA500 80%) no-repeat !important;
background: -o-linear-gradient(top, #FFA500 40%, #FFA500 80%) no-repeat !important;
background: linear-gradient(top, #FFA500 40%, #FFA500 80%) no-repeat !important;
}
</style> -->
<table>
<thead>
<tr class="header">
<th>Attribute</th>
<th>Parametric</th>
<th>Nonparametric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>distribution</td>
<td>normaly distributed</td>
<td>any distribution</td>
</tr>
<tr class="even">
<td>sampling</td>
<td>random sample</td>
<td>random sample</td>
</tr>
<tr class="odd">
<td>sensitivity to outliers</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="even">
<td>works with</td>
<td>large data sets</td>
<td>small and large data sets</td>
</tr>
<tr class="odd">
<td>speed</td>
<td>fast</td>
<td>slow</td>
</tr>
</tbody>
</table>
</div>
<div id="ranking" class="section level2 subsection">
<h2>Ranking</h2>
<pre class="r"><code>x = c(1, 4, 6, 7, 8, 9)
y = c(1, 4, 6, 7, 8, 39)

layout(matrix(1:2, 1, 2))
boxplot(x, horizontal=T, col=&#39;red&#39;)
boxplot(y, horizontal=T, col=&#39;red&#39;)</code></pre>
<hr />
<p><img src="non_parametric_tests_handout_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>rbind(rx = rank(x), ry = rank(y))</code></pre>
<pre><code>##    [,1] [,2] [,3] [,4] [,5] [,6]
## rx    1    2    3    4    5    6
## ry    1    2    3    4    5    6</code></pre>
</div>
<div id="ties" class="section level2 subsection">
<h2>Ties</h2>
<pre class="r"><code>x = c(1, 4, 6, 7, 8, 8, 4, 7, 9)

rbind(x, ordered = sort(x), non.tied.rank = 1:length(x), ranked = rank(sort(x)))</code></pre>
<pre><code>##               [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
## x                1  4.0  6.0    7  8.0  8.0  4.0  7.0    9
## ordered          1  4.0  4.0    6  7.0  7.0  8.0  8.0    9
## non.tied.rank    1  2.0  3.0    4  5.0  6.0  7.0  8.0    9
## ranked           1  2.5  2.5    4  5.5  5.5  7.5  7.5    9</code></pre>
<p><span class="math display">\[\frac{2 + 3}{2} = 2.5,  \frac{5 + 6}{2} = 5.5,  \frac{7 + 8}{2} = 7.5\]</span></p>
</div>
<div id="procedure" class="section level2 subsection">
<h2>Procedure</h2>
<ol style="list-style-type: decimal">
<li>Assumption: independent random samples.</li>
<li>Hypothesis: <br><span class="math inline">\(H_0\)</span> : equal population distributions (implies equal mean ranking) <br><span class="math inline">\(H_A\)</span> : unequal mean ranking (two sided) <br><span class="math inline">\(H_A\)</span> : higher mean ranking for one group.</li>
<li>Test statistic is difference between mean or sum of ranking.</li>
<li>Standardise test statistic</li>
<li>Calculate <em>P</em>-value one or two sided.</li>
<li>Conclude to reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(p &lt; \alpha\)</span>.</li>
</ol>
</div>
</div>
<div id="wilcoxon-rank-sum-test" class="section level1">
<h1>Wilcoxon rank-sum test</h1>
<p>Independent 2 samples</p>
<div id="wilcoxon-rank-sum-test-1" class="section level2 section">
<h2>Wilcoxon rank-sum test</h2>
<p><img src="http://upload.wikimedia.org/wikipedia/en/9/9a/FrankWilcoxon.png" style="float: left; margin: 0 20px 0 0;"></p>
<p>Developed by <a href="http://en.wikipedia.org/wiki/Frank_Wilcoxon">Frank Wilcoxon</a> the rank-sum test is a <a href="http://en.wikipedia.org/wiki/Nonparametric_statistics">nonparametric</a> alternative to the independent samples t-test.</p>
<p>By first ranking <span class="math inline">\(x\)</span> and then sum these ranks per group one would expect, under the null hypothesis, equal values for both groups.</p>
<p>After standardising this difference one can test using a standard normal distribution.</p>
</div>
<div id="sum-the-ranks" class="section level2">
<h2>Sum the ranks</h2>
<p><a href="https://webcolleges.uva.nl/Mediasite/Play/b40cac063f17441ea073977924ff07eb1d?playFrom=1435000">Sum the ranks example for height for males and females.</a></p>
</div>
<div id="simulate-data" class="section level2">
<h2>Simulate data</h2>
<pre class="r"><code>n      = 20
factor = rep(c(&quot;Ecstasy&quot;,&quot;Alcohol&quot;),each=n/2)
dummy  = ifelse(factor == &quot;Ecstacy&quot;, 0, 1)
b.0    = 23
b.1    = 5
error  = rnorm(n, 0, 1.7)
depres = b.0 + b.1*dummy + error
depres = round(depres)

data &lt;- data.frame(factor, depres)

## add the ranks
data$R &lt;- rank(data$depres)</code></pre>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<div id="htmlwidget-0153b338b23a28f34718" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0153b338b23a28f34718">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],["Ecstasy","Ecstasy","Ecstasy","Ecstasy","Ecstasy","Ecstasy","Ecstasy","Ecstasy","Ecstasy","Ecstasy","Alcohol","Alcohol","Alcohol","Alcohol","Alcohol","Alcohol","Alcohol","Alcohol","Alcohol","Alcohol"],[27,29,27,27,30,26,29,31,28,28,28,26,29,29,27,28,32,27,26,29],[6,15,6,6,18,2,15,19,10.5,10.5,10.5,2,15,15,6,10.5,20,6,2,15]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>factor<\/th>\n      <th>depres<\/th>\n      <th>R<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"scrollY":415,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="calculate-the-sum-of-ranks-per-group" class="section level2 subsection">
<h2>Calculate the sum of ranks per group</h2>
<pre class="r"><code>R &lt;- aggregate(R ~ factor, data, sum)
R</code></pre>
<pre><code>##    factor   R
## 1 Alcohol 102
## 2 Ecstasy 108</code></pre>
</div>
<div id="so-w-is-the-lowest" class="section level2">
<h2>So W is the lowest</h2>
<p><span class="math display">\[W=min\left(\sum{R_1},\sum{R_2}\right)\]</span></p>
<pre class="r"><code>W &lt;- min(R$R)
W</code></pre>
<pre><code>## [1] 102</code></pre>
</div>
<div id="standardise-w" class="section level2">
<h2>Standardise W</h2>
<p>To calculate the Z score we need to standardise the W. To do so we need the mean W and the standard error of W.</p>
<p>For this we need the sample sizes for each group.</p>
<pre class="r"><code>n &lt;- aggregate(R ~ factor, data, length)

n.1 = n$R[1]
n.2 = n$R[2]

cbind(n.1, n.2)</code></pre>
<pre><code>##      n.1 n.2
## [1,]  10  10</code></pre>
</div>
<div id="mean-w" class="section level2">
<h2>Mean W</h2>
<p><span class="math display">\[\bar{W}_s=\frac{n_1(n_1+n_2+1)}{2}\]</span></p>
<pre class="r"><code>W.mean = (n.1*(n.1+n.2+1))/2
W.mean</code></pre>
<pre><code>## [1] 105</code></pre>
</div>
<div id="se-w" class="section level2">
<h2>SE W</h2>
<p><span class="math display">\[{SE}_{\bar{W}_s}=\sqrt{ \frac{n_1 n_2 (n_1+n_2+1)}{12} }\]</span></p>
<pre class="r"><code>W.se = sqrt((n.1*n.2*(n.1+n.2+1))/12)
W.se</code></pre>
<pre><code>## [1] 13.22876</code></pre>
</div>
<div id="calculate-z" class="section level2 subsection">
<h2>Calculate Z</h2>
<p><span class="math display">\[z = \frac{W - \bar{W}}{{SE}_W}\]</span></p>
<p>Which looks a lot like</p>
<p><span class="math display">\[\frac{X - \bar{X}}{{SE}_X} \text{or} \frac{b - \mu_{b}}{{SE}_b} \]</span></p>
<pre class="r"><code>z = (W - W.mean) / W.se
z</code></pre>
<pre><code>## [1] -0.2267787</code></pre>
</div>
<div id="test-for-significance-1-sided" class="section level2">
<h2>Test for significance 1 sided</h2>
<pre class="r"><code>if(!&quot;visualize&quot; %in% installed.packages()){ install.packages(&quot;visualize&quot;) }
library(&quot;visualize&quot;)

visualize.norm(z, section=&quot;lower&quot;)</code></pre>
<hr />
<p><img src="non_parametric_tests_handout_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="test-for-significance-2-sided" class="section level2">
<h2>Test for significance 2 sided</h2>
<pre class="r"><code>visualize.norm(c(z,-z), section=&quot;tails&quot;)</code></pre>
<hr />
<p><img src="non_parametric_tests_handout_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="effect-size" class="section level2">
<h2>Effect size</h2>
<p><span class="math display">\[r = \frac{z}{\sqrt{N}}\]</span></p>
<pre class="r"><code>N = sum(n$R)
r = z / sqrt(N)
r</code></pre>
<pre><code>## [1] -0.05070926</code></pre>
</div>
<div id="mannwhitney-test" class="section level2 section">
<h2>Mann–Whitney test</h2>
<p><span class="math display">\[U = n_1 n_2 + \frac{n_1 (n_1 + 1)}{2} - R_1\]</span></p>
<pre class="r"><code>U = (n.1*n.2)+(n.1*(n.1+1))/2-R$R[1]
U</code></pre>
<pre><code>## [1] 53</code></pre>
</div>
<div id="baru-and-se_u-for-non-tied-ranks" class="section level2 subsection">
<h2><span class="math inline">\(\bar{U}\)</span> and <span class="math inline">\({SE}_U\)</span> for non tied ranks</h2>
<p><span class="math display">\[\bar{U} = \frac{n_1 n_2}{2}\]</span></p>
<pre class="r"><code>(n.1*n.2)/2</code></pre>
<pre><code>## [1] 50</code></pre>
<p><span class="math display">\[{SE}_U = \sqrt{\frac{n_1 n_2 (n_1 + n_2 + 1)}{12}}\]</span></p>
<pre class="r"><code>sqrt((n.1*n.2*(n.1+n.2+1))/12)</code></pre>
<pre><code>## [1] 13.22876</code></pre>
</div>
</div>
<div id="wilcoxon-signed-rank-test" class="section level1">
<h1>Wilcoxon signed-rank test</h1>
<p>Paired 2 samples</p>
<div id="wilcoxon-signed-rank-test-1" class="section level2 section">
<h2>Wilcoxon signed-rank test</h2>
<p><img src="http://upload.wikimedia.org/wikipedia/en/9/9a/FrankWilcoxon.png" style="float: left; margin: 0 20px 0 0; width: 10%;"></p>
<p>The Wilcoxon signed-rank test is a nonparametric alternative to the paired samples t-test. It assigns + or - signs to the difference between two repeated measures. By ranking the differences and summing these ranks for the positive group, the null hypothesis is tested that both positive and negative differences are equal.</p>
</div>
<div id="simulate-data-1" class="section level2">
<h2>Simulate data</h2>
<pre class="r"><code>n      = 20
factor = rep(c(&quot;Ecstasy&quot;,&quot;Alcohol&quot;),each=n/2)
dummy  = ifelse(factor == &quot;Ecstacy&quot;, 0, 1)
b.0    = 23
b.1    = 5
error  = rnorm(n, 0, 1.7)
depres = b.0 + b.1*dummy + error
depres = round(depres)

data &lt;- data.frame(factor, depres)

Ecstasy &lt;- subset(data, factor==&quot;Ecstasy&quot;)$depres
Alcohol &lt;- subset(data, factor==&quot;Alcohol&quot;)$depres

data &lt;- data.frame(Ecstasy, Alcohol)</code></pre>
</div>
<div id="example-1" class="section level2">
<h2>Example</h2>
<div id="htmlwidget-a275141ffaf4bd4f06d8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a275141ffaf4bd4f06d8">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],[29,25,28,27,29,28,28,29,29,28],[28,28,27,27,28,28,26,27,30,28]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Ecstasy<\/th>\n      <th>Alcohol<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"iDisplayLength":7,"searching":false,"scrollY":415,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="calculate-t" class="section level2 smaller subsection">
<h2>Calculate T</h2>
<!-- Dit gaat niet goed Ranking moet zonder de ties en absoluut. 

data$difference = abs(data$Ecstasy - data$Alcohol)

data$rank <- NA

data

data[which(data$difference != 0),'rank'] <- rank(data[which(data$difference != 0),'difference'])


-->
<pre class="r"><code># Calculate difference in scores between first and second measure
data$difference = data$Ecstasy - data$Alcohol

# Calculate absolute difference in scores between first and second measure
data$abs.difference = abs(data$Ecstasy - data$Alcohol)

# Create rank variable with place holder NA
data$rank &lt;- NA

# Rank only the difference scores
data[which(data$difference != 0),&#39;rank&#39;] &lt;- rank(data[which(data$difference != 0),
                                                      &#39;abs.difference&#39;])

# Assign a &#39;+&#39; or a &#39;-&#39; to those values 
data$sign = sign(data$Ecstasy - data$Alcohol)

# Add positive and negative rank to     test  if    else
data$rank_pos = with(data, ifelse(sign ==  1, rank, 0   ))
data$rank_neg = with(data, ifelse(sign == -1, rank, 0   ))</code></pre>
</div>
<div id="the-data" class="section level2 smaller">
<h2>The data</h2>
<div id="htmlwidget-e9d2f9e2580c2f32ed72" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e9d2f9e2580c2f32ed72">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],[29,25,28,27,29,28,28,29,29,28],[28,28,27,27,28,28,26,27,30,28],[1,-3,1,0,1,0,2,2,-1,0],[1,3,1,0,1,0,2,2,1,0],[2.5,7,2.5,null,2.5,null,5.5,5.5,2.5,null],[1,-1,1,0,1,0,1,1,-1,0],[2.5,0,2.5,0,2.5,0,5.5,5.5,0,0],[0,7,0,0,0,0,0,0,2.5,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Ecstasy<\/th>\n      <th>Alcohol<\/th>\n      <th>difference<\/th>\n      <th>abs.difference<\/th>\n      <th>rank<\/th>\n      <th>sign<\/th>\n      <th>rank_pos<\/th>\n      <th>rank_neg<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"iDisplayLength":7,"searching":false,"scrollY":415,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="calculate-t_" class="section level2">
<h2>Calculate <span class="math inline">\(T_+\)</span></h2>
<pre class="r"><code># Calculate the sum of the positive ranks
T_pos = sum(data$rank_pos)
T_pos</code></pre>
<pre><code>## [1] 18.5</code></pre>
<pre class="r"><code># Calculate N without 0 (no differences).
n = sum(abs(data$sign))
n</code></pre>
<pre><code>## [1] 7</code></pre>
</div>
<div id="calculate-bart-and-se_t" class="section level2 subsection">
<h2>Calculate <span class="math inline">\(\bar{T}\)</span> and <span class="math inline">\({SE}_{T}\)</span></h2>
<p><span class="math display">\[\bar{T} = \frac{n(n+1)}{4}\]</span></p>
<pre class="r"><code>T_mean = (n*(n+1))/4
T_mean</code></pre>
<pre><code>## [1] 14</code></pre>
<p><span class="math display">\[{SE}_{T} = \sqrt{\frac{n(n+1)(2n+1)}{24}}\]</span></p>
<pre class="r"><code>SE_T = sqrt( (n*(n+1)*(2*n+1)) / 24 )</code></pre>
</div>
<div id="calculate-z-1" class="section level2">
<h2>Calculate Z</h2>
<p><span class="math display">\[z = \frac{T_+ - \bar{T}}{{SE}_T}\]</span></p>
<pre class="r"><code>z = (T_pos - T_mean)/SE_T
z</code></pre>
<pre><code>## [1] 0.7606388</code></pre>
</div>
<div id="test-for-significance" class="section level2">
<h2>Test for significance</h2>
<pre class="r"><code>visualize.norm(c(z,-z), section=&quot;tails&quot;)</code></pre>
<hr />
<p><img src="non_parametric_tests_handout_files/figure-html/unnamed-chunk-34-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="effect-size-1" class="section level2">
<h2>Effect size</h2>
<p><span class="math display">\[r = \frac{z}{\sqrt{N}}\]</span></p>
<p>Here <span class="math inline">\(N\)</span> is the number of observations.</p>
<pre class="r"><code>N = 20
r = z / sqrt(N)
r</code></pre>
<pre><code>## [1] 0.170084</code></pre>
</div>
</div>
<div id="kruskalwallis-test" class="section level1 section">
<h1>Kruskal–Wallis test</h1>
<p>Independent &gt;2 samples</p>
<div id="kruskalwallis-test-1" class="section level2">
<h2>Kruskal–Wallis test</h2>
<p><img src="http://owpdb.mfo.de/photoNormal?id=15500" style="float: left; margin: 0 20px 0 0; height: 150px;"> <img src="http://www.peoples.ru/science/economy/wilson_allen_wallis/wallis_1.jpg" style="float: left; margin: 0 20px 0 0; height: 150px;"></p>
<p>Created by <a href="http://en.wikipedia.org/wiki/William_Kruskal">William Henry Kruskal</a> (L) and <a href="http://en.wikipedia.org/wiki/W._Allen_Wallis">Wilson Allen Wallis</a> (R), the Kruskal-Wallis test is a nonparametric alternative to the independent one-way ANOVA.</p>
<p>The Kruskal-Wallis test essentially subtracts the expected mean ranking from the calculated oberved mean ranking, which is <span class="math inline">\(\chi^2\)</span> distributed.</p>
</div>
<div id="simulate-data-2" class="section level2">
<h2>Simulate data</h2>
<pre class="r"><code>n      = 30
factor = rep(c(&quot;ecstasy&quot;,&quot;alcohol&quot;,&quot;control&quot;), each=n/3)

dummy.1 = ifelse(factor == &quot;alcohol&quot;, 1, 0)
dummy.2 = ifelse(factor == &quot;ecstasy&quot;, 1, 0)
b.0     = 23
b.1     = 0
b.2     = 0
error   = rnorm(n, 0, 1.7)

# Model
depres  = b.0 + b.1*dummy.1 + b.2*dummy.2 + error
depres  = round(depres)

data &lt;- data.frame(factor, depres)</code></pre>
</div>
<div id="assign-ranks" class="section level2 subsection">
<h2>Assign ranks</h2>
<pre class="r"><code># Assign ranks
data$ranks = rank(data$depres)</code></pre>
</div>
<div id="the-data-1" class="section level2">
<h2>The data</h2>
<div id="htmlwidget-49a18f4ab25782c65d15" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-49a18f4ab25782c65d15">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],["ecstasy","ecstasy","ecstasy","ecstasy","ecstasy","ecstasy","ecstasy","ecstasy","ecstasy","ecstasy","alcohol","alcohol","alcohol","alcohol","alcohol","alcohol","alcohol","alcohol","alcohol","alcohol","control","control","control","control","control","control","control","control","control","control"],[22,22,24,25,21,24,21,23,21,23,27,23,24,24,21,26,23,24,23,24,23,22,21,22,22,25,22,22,22,23],[9.5,9.5,23.5,27.5,3,23.5,3,17,3,17,30,17,23.5,23.5,3,29,17,23.5,17,23.5,17,9.5,3,9.5,9.5,27.5,9.5,9.5,9.5,17]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>factor<\/th>\n      <th>depres<\/th>\n      <th>ranks<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"iDisplayLength":7,"searching":false,"scrollY":415,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="calculate-h" class="section level2 subsection">
<h2>Calculate H</h2>
<p><span class="math display">\[H = \frac{12}{N(N+1)} \sum_{i=1}^k \frac{R_i^2}{n_i} - 3(N+1)\]</span></p>
<ul>
<li><span class="math inline">\(N\)</span> total sample size</li>
<li><span class="math inline">\(n_i\)</span> sample size per group</li>
<li><span class="math inline">\(k\)</span> number of groups</li>
<li><span class="math inline">\(R_i\)</span> rank sums per group</li>
</ul>
</div>
<div id="calculate-h-1" class="section level2">
<h2>Calculate H</h2>
<pre class="r"><code># Now we need the sum of the ranks per group.
R.i = aggregate(ranks ~ factor, data = data, sum)$ranks
R.i</code></pre>
<pre><code>## [1] 207.0 121.5 136.5</code></pre>
<pre class="r"><code># De total sample size N is:
N = nrow(data)

# And the sample size per group is n_i:
n.i = aggregate(depres ~ factor, data=data, length)$depres
n.i</code></pre>
<pre><code>## [1] 10 10 10</code></pre>
</div>
<div id="calculate-h-2" class="section level2">
<h2>Calculate H</h2>
<p><span class="math display">\[H = \frac{12}{N(N+1)} \sum_{i=1}^k \frac{R_i^2}{n_i} - 3(N+1)\]</span></p>
<pre class="r"><code>H = ( 12/(N*(N+1)) ) * sum(R.i^2/n.i) - 3*(N+1)
H</code></pre>
<pre><code>## [1] 5.37871</code></pre>
<p>And the degrees of freedom</p>
<pre class="r"><code>k  = 3
df = k - 1</code></pre>
</div>
<div id="test-for-significance-1" class="section level2 subsection">
<h2>Test for significance</h2>
<pre class="r"><code>visualize.chisq(H, df, section=&quot;upper&quot;)</code></pre>
<hr />
<p><img src="non_parametric_tests_handout_files/figure-html/unnamed-chunk-43-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="friedmans-anova" class="section level1">
<h1>Friedman’s ANOVA</h1>
<p>Paired &gt;2 samples</p>
<div id="friedmans-anova-1" class="section level2 section">
<h2>Friedman’s ANOVA</h2>
<p><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/William-Friedman.jpg/220px-William-Friedman.jpg" style="float: left; margin: 0 20px 0 0; height: 150px;"></p>
<p>Created by <a href="http://en.wikipedia.org/wiki/William_F._Friedman">William Frederick Friedman</a> the Friedman’s ANOVA is a nonparametric alternative to the repeated one-way ANOVA.</p>
<p>Just like the Kruskal-Wallis test, Friedman’s ANOVA, subtracts the expected mean ranking from the calculated observed mean ranking, which is also <span class="math inline">\(\chi^2\)</span> distributed.</p>
</div>
<div id="simulate-data-3" class="section level2">
<h2>Simulate data</h2>
<pre class="r"><code>n      = 30
factor = rep(c(&quot;ecstasy&quot;,&quot;alcohol&quot;,&quot;control&quot;), each=n/3)

dummy.1 = ifelse(factor == &quot;alcohol&quot;, 1, 0)
dummy.2 = ifelse(factor == &quot;ecstasy&quot;, 1, 0)
b.0     = 23
b.1     = 0
b.2     = 0
error   = rnorm(n, 0, 1.7)

# Model
depres  = b.0 + b.1*dummy.1 + b.2*dummy.2 + error
depres  = round(depres)

data &lt;- data.frame(factor, depres)</code></pre>
</div>
<div id="simulate-data-4" class="section level2">
<h2>Simulate data</h2>
<pre class="r"><code>ecstasy &lt;- subset(data, factor==&quot;ecstasy&quot;)$depres
alcohol &lt;- subset(data, factor==&quot;alcohol&quot;)$depres
control &lt;- subset(data, factor==&quot;control&quot;)$depres

data &lt;- data.frame(ecstasy, alcohol, control)</code></pre>
</div>
<div id="the-data-2" class="section level2">
<h2>The data</h2>
<div id="htmlwidget-3d9f96570b1b87960cf3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3d9f96570b1b87960cf3">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],[23,24,27,27,25,21,22,21,23,24],[22,24,24,21,25,22,22,25,24,24],[24,27,25,21,21,23,24,21,23,21]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ecstasy<\/th>\n      <th>alcohol<\/th>\n      <th>control<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"iDisplayLength":7,"searching":false,"scrollY":415,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="assign-ranks-1" class="section level2">
<h2>Assign ranks</h2>
<p>Rank each row.</p>
<pre class="r"><code># Rank for each person
ranks = t(apply(data, 1, rank))</code></pre>
</div>
<div id="the-data-with-ranks" class="section level2">
<h2>The data with ranks</h2>
<div id="htmlwidget-f411693a41e8320b8937" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f411693a41e8320b8937">{"x":{"filter":"none","data":[[2,1.5,3,3,2.5,1,1.5,1.5,1.5,2.5],[1,1.5,1,1.5,2.5,2,1.5,3,3,2.5],[3,3,2,1.5,1,3,3,1.5,1.5,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ecstasy<\/th>\n      <th>alcohol<\/th>\n      <th>control<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"iDisplayLength":7,"searching":false,"scrollY":415,"paging":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="calculate-f_r" class="section level2 subsection">
<h2>Calculate <span class="math inline">\(F_r\)</span></h2>
<p><span class="math display">\[F_r = \left[ \frac{12}{Nk(k+1)} \sum_{i=1}^k R_i^2 \right] - 3N(k+1)\]</span></p>
<ul>
<li><span class="math inline">\(N\)</span> total number of subjects</li>
<li><span class="math inline">\(k\)</span> number of groups</li>
<li><span class="math inline">\(R_i\)</span> rank sums for each group</li>
</ul>
</div>
<div id="calculate-f_r-1" class="section level2">
<h2>Calculate <span class="math inline">\(F_r\)</span></h2>
<p>Calculate ranks sum per condition and <span class="math inline">\(N\)</span>.</p>
<pre class="r"><code>R.i = apply(ranks, 2, sum)
R.i</code></pre>
<pre><code>## ecstasy alcohol control 
##    20.0    19.5    20.5</code></pre>
<pre class="r"><code># N is number of participants
N = 10</code></pre>
</div>
<div id="calculate-f_r-2" class="section level2">
<h2>Calculate <span class="math inline">\(F_r\)</span></h2>
<p><span class="math display">\[F_r = \left[ \frac{12}{Nk(k+1)} \sum_{i=1}^k R_i^2 \right] - 3N(k+1)\]</span></p>
<pre class="r"><code>k = 3
F.r = ( ( 12/(N*k*(k+1)) ) * sum(R.i^2) ) - ( 3*N*(k+1) )
F.r</code></pre>
<pre><code>## [1] 0.05</code></pre>
<p>And the degrees of freedom</p>
<pre class="r"><code>df = k - 1</code></pre>
</div>
<div id="test-for-significance-2" class="section level2">
<h2>Test for significance</h2>
<pre class="r"><code>visualize.chisq(F.r, df, section=&quot;upper&quot;)</code></pre>
<hr />
<p><img src="non_parametric_tests_handout_files/figure-html/unnamed-chunk-53-1.png" width="672" style="display: block; margin: auto;" /></p>
<!-- Footer insert below -->
</div>
</div>
<div id="end" class="section level1">
<h1>End</h1>
<div id="contact" class="section level2">
<h2>Contact</h2>
<script src="https://use.fontawesome.com/23c1d38eea.js"></script>
<ul class="fa-ul" style="color:black; list-style:none;">
<li>
<i class="fa-li fa fa-twitter"></i> <a href="https://twitter.com/shklinkenberg" target="_blank" style="color:black; border-bottom:none;"><span class="citation">@shklinkenberg</span></a>
</li>
<li>
<i class="fa-li fa fa-linkedin-square"></i> <a href="https://www.linkedin.com/in/sharonklinkenberg/" target="_blank" style="color:black; border-bottom:none;">Klinkenberg</a>
</li>
<li>
<i class="fa-li fa fa-envelope-o"></i> <a style="unicode-bidi:bidi-override; direction: rtl; color:black" href="javascript:window.location.href = 'mailto:' + ['s.klinkenberg','uva.nl'].join('@')">ln.AvU@grebneknilK.S</a>
</li>
<li>
<i class="fa-li fa fa-github"></i> <a href="https://github.com/ShKlinkenberg" target="_blank" style="color:black; border-bottom:none;">ShKlinkenberg</a>
</li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
