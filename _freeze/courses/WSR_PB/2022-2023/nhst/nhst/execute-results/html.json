{
  "hash": "3f598c1f94c9eba103b40b43d410bc00",
  "result": {
    "markdown": "---\ntitle: \"Null Hypothesis Testing\"\nauthor: \"Klinkenberg\"\ndate: \"13 sep 2022\"\n---\n\n\n\n\n# Null Hypothesis<br>Significance Testing {.section}\n\n## Neyman-Pearson Paradigm\n\n[Neyman](https://en.wikipedia.org/wiki/Jerzy_Neyman)-[Pearson](https://en.wikipedia.org/wiki/Egon_Pearson) Paradigm\n\n<style>\n.np { height: 400px;\n      float: left;\n    }\n</style>\n\n<img class=\"np\" src=\"https://upload.wikimedia.org/wikipedia/commons/8/8e/Jerzy_Neyman2.jpg\">\n\n<img class=\"np\" src=\"https://upload.wikimedia.org/wikipedia/en/a/a2/Egon_Pearson.jpg\">\n\n<br>\n\n## $H_0$ and $H_A$ {.subsection}\n\n<table style=\"width:100%; border: none;\">\n  \n<tr><td>\n\n$H_0$\n\n* Skeptical point of view\n* No effect\n* No preference\n* No Correlation\n* No difference\n\n</td><td>\n\n$H_A$\n\n* Refute Skepticism\n* Effect\n* Preference\n* Correlation\n* Difference\n\n</td></tr></table>\n\n## Frequentist probability {.subsection}\n\n* Objective Probability\n* Relative frequency in the long run\n\n## Standard Error {.subsection}\n\n> 95% confidence interval \n\n$$SE = \\frac{\\text{Standard deviation}}{\\text{Square root of sample size}} = \\frac{s}{\\sqrt{n}}$$\n\n* Lowerbound = $\\bar{x} - 1.96 \\times SE$\n* Upperbound = $\\bar{x} + 1.96 \\times SE$\n\n## Standard Error {.flexbox .vcenter}\n\n<style>\nul#menu li {\n    display:inline;\n}\n</style>\n\n<div onLoad=\"execute(10,10)\">\n\n<ul  id=\"menu\">\n  <li>n₁ = <input type=\"number\" name=\"n_x1\" id=\"n_x1\" min=\"10\" max=\"100\" value=\"10\" onclick=\"execute(document.getElementById('n_x1').value,document.getElementById('n_x2').value)\" onchange=\"execute(document.getElementById('n_x1').value,document.getElementById('n_x2').value)\"/></li>\n  <li>n₂ = <input type=\"number\" name=\"n_x2\" id=\"n_x2\" min=\"10\" max=\"100\" value=\"10\" onclick=\"execute(document.getElementById('n_x1').value,document.getElementById('n_x2').value)\" onchange=\"execute(document.getElementById('n_x1').value,document.getElementById('n_x2').value)\"/></li>\n</ul>\n\n<canvas id     = \"myCanvas\" \n        width  = \"600\" \n        height = \"400\" \n        style  = \"border:1px solid #c3c3c3;\">\nYour browser does not support the canvas element.\n</canvas>\n\n<script type=\"text/javascript\"  charset=\"utf-8\">\n\nfunction execute(n_x1, n_x2) {\n\t\nvar c         = document.getElementById(\"myCanvas\");\nvar ctx       = c.getContext(\"2d\");\n\n// clear canvas\n//ctx.clearRect(0,0,600,400);\n\n// Store the current transformation matrix\nctx.save();\n\n// Use the identity matrix while clearing the canvas\nctx.setTransform(1, 0, 0, 1, 0, 0);\nctx.clearRect(0, 0, 600, 400);\nctx.beginPath();\n\n// Restore the transform\nctx.restore();\n\n\n\nctx.font      = \"20pt Calibri\";\nctx.fillStyle = \"#000000\"; // text color\nctx.fillText(\"The influence of n on the confidence interval\", 50, 50);\n\n\n\nvar mean_x1 = 5;\nvar mean_x2 = 7;\nvar   sd_x1 = 2.6;\nvar   sd_x2 = 2.7;\nvar    n_x1 = n_x1;\nvar    n_x2 = n_x2;\nvar   se_x1 = sd_x1/Math.sqrt(n_x1);\nvar   se_x2 = sd_x2/Math.sqrt(n_x2);\n\nvar text_x_pos = 50;\nvar text_y_pos = 210;\nvar text_guter = 20;\n\nctx.font      = \"14pt Calibri\";\nctx.fillStyle = \"#000000\"; // text color\nctx.fillText(\"x̄₁ = \"+mean_x1, text_x_pos, text_y_pos);\nctx.fillText(\"x̄₂ = \"+mean_x2, text_x_pos, text_y_pos+1*text_guter);\nctx.fillText(\"σ₁ = \"+sd_x1,  text_x_pos, text_y_pos+2*text_guter);\nctx.fillText(\"σ₂ = \"+sd_x2,  text_x_pos, text_y_pos+3*text_guter);\nctx.fillText(\"n₁ = \"+n_x1,    text_x_pos, text_y_pos+4*text_guter);\nctx.fillText(\"n₂ = \"+n_x2,    text_x_pos, text_y_pos+5*text_guter);\nctx.fillText(\"se₁ = σ₁/√n₁ = \"+sd_x1+\"/√\"+n_x1+\" = \"+se_x1.toFixed(2), text_x_pos, text_y_pos+6*text_guter);\nctx.fillText(\"se₂ = σ₂/√n₂ = \"+sd_x2+\"/√\"+n_x2+\" = \"+se_x2.toFixed(2), text_x_pos, text_y_pos+7*text_guter);\n\nvar hight_x1 = (250/10)*mean_x1;\nvar hight_x2 = (250/10)*mean_x2;\n\nvar   sd_x1 = (250/10)*sd_x1;\nvar   sd_x2 = (250/10)*sd_x2;\n\nvar   se_x1 = 1.96*sd_x1/Math.sqrt(n_x1);\nvar   se_x2 = 1.96*sd_x2/Math.sqrt(n_x2);\n\nvar bar_x_pos  = 315;\nvar bar_y_pos  = 350;\nvar bar_width  = 100;\nvar bar_gutter = 35;\n\nctx.fillStyle = \"#87ceeb\";\nctx.fillRect(bar_x_pos, bar_y_pos-hight_x1,  bar_width,hight_x1);\n\nctx.fillStyle = \"#87ceeb\";\nctx.fillRect(bar_x_pos+bar_width+bar_gutter, bar_y_pos-hight_x2,  bar_width,hight_x2);\n\n\nctx.moveTo(bar_x_pos+(bar_width/2), bar_y_pos-hight_x1+se_x1);\nctx.lineTo(bar_x_pos+(bar_width/2), bar_y_pos-hight_x1-se_x1);\nctx.stroke();\n\nctx.moveTo(bar_x_pos+(bar_width/4),   bar_y_pos-hight_x1-se_x1); // upper bound \nctx.lineTo(bar_x_pos+(bar_width/4*3), bar_y_pos-hight_x1-se_x1); // upper bound\nctx.stroke();\n\nctx.moveTo(bar_x_pos+(bar_width/4),   bar_y_pos-hight_x1+se_x1); // lower bound \nctx.lineTo(bar_x_pos+(bar_width/4*3), bar_y_pos-hight_x1+se_x1); // lower bound\nctx.stroke();\n\nctx.moveTo(bar_x_pos+bar_width+bar_gutter+(bar_width/2), bar_y_pos-hight_x2+se_x2);\nctx.lineTo(bar_x_pos+bar_width+bar_gutter+(bar_width/2), bar_y_pos-hight_x2-se_x2);\nctx.stroke();\n\nctx.moveTo(bar_x_pos+bar_width+bar_gutter+(bar_width/4),   bar_y_pos-hight_x2-se_x2); // upper bound \nctx.lineTo(bar_x_pos+bar_width+bar_gutter+(bar_width/4*3), bar_y_pos-hight_x2-se_x2); // upper bound\nctx.stroke();\n\nctx.moveTo(bar_x_pos+bar_width+bar_gutter+(bar_width/4),   bar_y_pos-hight_x2+se_x2); // lower bound \nctx.lineTo(bar_x_pos+bar_width+bar_gutter+(bar_width/4*3), bar_y_pos-hight_x2+se_x2); // lower bound\nctx.stroke();\n\n// X in bar\nctx.fillStyle = \"#000\";\nctx.font      = \"20pt Calibri\";\nctx.fillText(\"x₁\", bar_x_pos+10,                      bar_y_pos-hight_x1+hight_x1-10);\nctx.fillText(\"x₂\", bar_x_pos+bar_width+bar_gutter+10, bar_y_pos-hight_x2+hight_x2-10);\n\n// upper and lower bound text\nctx.fillStyle = \"#000\";\nctx.font      = \"10pt Calibri\";\nctx.fillText(\"1.96se₁+x̄₁\", bar_x_pos+(bar_width/4*3), bar_y_pos-hight_x1-se_x1+2);\nctx.fillText(\"1.96se₁-x̄₁\", bar_x_pos+(bar_width/4*3), bar_y_pos-hight_x1+se_x1+2);\n\nctx.fillText(\"1.96se₂+x̄₂\", bar_x_pos+bar_width+bar_gutter+(bar_width/4*3), bar_y_pos-hight_x2-se_x2+2);\nctx.fillText(\"1.96se₂-x̄₂\", bar_x_pos+bar_width+bar_gutter+(bar_width/4*3), bar_y_pos-hight_x2+se_x2+2);\n\n}\n</script>\n</div>\n\n::: {.cell}\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-3-1.png){width=672 height=600}\n:::\n:::\n\n\n\n## Binomial $H_0$ distribution\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 10   # Sample size\nk = 0:n  # Discrete probability space\np = .5   # Probability of head\n\nmunt = 0:1\n\npermutations = factorial(n) / ( factorial(k) * factorial(n-k) )\n# permutations\n\np_k  = p^k * (1-p)^(n-k)  # Probability of single event\np_kp = p_k * permutations # Probability of event times \n                          # the occurrence of that event\n\ntitle = \"Binomial Null distribution\"\n\n# col=c(rep(\"red\",2),rep(\"beige\",7),rep(\"red\",2))\n\nbarplot( p_kp, \n         main=title, \n         names.arg=0:n, \n         xlab=\"number of head\", \n         ylab=\"P(%)\", \n         col='beige',\n         ylim=c(0,.3) )\n\n# abline(v = c(2.5,10.9), lty=2, col='red')\n\ntext(.6:10.6*1.2,p_kp,round(p_kp,3),pos=3,cex=.5)\n```\n\n\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n## Binomial $H_A$ distribution\n\n::: {.cell}\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n## Decision table {.flexbox .vcenter .subsection}\n\n<table style=\"border: none;  transform: scale(1);\">\n  <col width=\"150px\">\n  <col width=\"225px\">\n  <col width=\"225px\">\n<tr><td></td style=\"width: 300px;\"><td>$H_0$ = True</td style=\"width: 300px;\"><td>$H_0$ = False</td></tr>\n<tr height=\"150px\">\n<td>Decide to<br>reject $H_0$</td>\n<td style = \"border: 5px solid white; padding: 10px; color: white; background-color: red;\">Type I error <br>Alpha $\\alpha$ </td>\n<td style = \"border: 5px solid white; padding: 10px; color: black; background-color: lightgreen;\">Correct <br>True positive = Power</td>\n</tr>\n<tr height=\"150px\">\n<td>Decide not<br>to reject $H_0$</td>   \n<td style = \"border: 5px solid white; padding: 10px; color: black; background-color: lightgreen;\">Correct <br> True negative</td>\n<td style = \"border: 5px solid white; padding: 10px; color: white; background-color: red;\">Type II error <br>Beta $\\beta$ </td>\n</tr>\n</table>\n\n## Alpha $\\alpha$ {.subsection}\n\n<table style=\"border: none;  transform: scale(.5); float:right; margin: -70px;\">\n  <col width=\"150px\">\n  <col width=\"225px\">\n  <col width=\"225px\">\n<tr><td></td style=\"width: 300px;\"><td>$H_0$ = True</td style=\"width: 300px;\"><td>$H_0$ = False</td></tr>\n<tr height=\"150px\">\n<td>Decide to<br>reject $H_0$</td>\n<td style = \"border: 5px solid blue; padding: 10px; color: white; background-color: red;\">Type I error <br>Alpha $\\alpha$ </td>\n<td style = \"border: 5px solid white; padding: 10px; color: black; background-color: lightgreen;\">Correct <br>True positive = Power</td>\n</tr>\n<tr height=\"150px\">\n<td>Decide not<br>to reject $H_0$</td>   \n<td style = \"border: 5px solid white; padding: 10px; color: black; background-color: lightgreen;\">Correct <br> True negative</td>\n<td style = \"border: 5px solid white; padding: 10px; color: white; background-color: red;\">Type II error <br>Beta $\\beta$ </td>\n</tr>\n</table>\n\n* Incorrectly reject $H_0$\n* Type I error\n* False Positive\n* Criteria often 5%\n* Distribution depends on sample size\n\n\n::: {.cell}\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n## Power {.subsection}\n\n<table style=\"border: none;  transform: scale(.5); float:right; margin: -70px;\">\n  <col width=\"150px\">\n  <col width=\"225px\">\n  <col width=\"225px\">\n<tr><td></td style=\"width: 300px;\"><td>$H_0$ = True</td style=\"width: 300px;\"><td>$H_0$ = False</td></tr>\n<tr height=\"150px\">\n<td>Decide to<br>reject $H_0$</td>\n<td style = \"border: 5px solid white; padding: 10px; color: white; background-color: red;\">Type I error <br>Alpha $\\alpha$ </td>\n<td style = \"border: 5px solid blue; padding: 10px; color: black; background-color: lightgreen;\">Correct <br>True positive = Power</td>\n</tr>\n<tr height=\"150px\">\n<td>Decide not<br>to reject $H_0$</td>   \n<td style = \"border: 5px solid white; padding: 10px; color: black; background-color: lightgreen;\">Correct <br> True negative</td>\n<td style = \"border: 5px solid white; padding: 10px; color: white; background-color: red;\">Type II error <br>Beta $\\beta$ </td>\n</tr>\n</table>\n\n\n* Correctly reject $H_0$\n* True positive\n* Power equal to: 1 - Beta\n    * Beta is Type II error\n* Criteria often 80%\n* Depends on sample size\n\n::: {.cell}\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n## Post-Hoc Power {.subsection}\n\n* Also known as: observed, retrospective, achieved, prospective and a priori power\n* Specificly meaning:\n\n> The power of a test assuming a population effect size equal to the observed effect size in the current sample.\n\nSource: [O'Keefe (2007)](http://www.dokeefe.net/pub/okeefe07cmm-posthoc.pdf)\n\n## Effect size {.subsection}\n\nIn statistics, an effect size is a quantitative measure of the strength of a phenomenon.  Examples of effect sizes are the correlation between two variables, the regression coefficient in a regression, the mean difference and standardised differences.\n\nFor each type of effect size, a larger absolute value always indicates a stronger effect. Effect sizes complement statistical hypothesis testing, and play an important role in power analyses, sample size planning, and in meta-analyses.\n\nSource: [WIKIPEDIA](https://en.wikipedia.org/wiki/Effect_size)\n\n## Effect size {.flexbox .vcenter}\n\n![](../../../topics/NHST/effec_size.png)\n\n## 1 - alpha {.subsection}\n\n<table style=\"border: none;  transform: scale(.5); float:right; margin: -70px;\">\n  <col width=\"150px\">\n  <col width=\"225px\">\n  <col width=\"225px\">\n<tr><td></td style=\"width: 300px;\"><td>$H_0$ = True</td style=\"width: 300px;\"><td>$H_0$ = False</td></tr>\n<tr height=\"150px\">\n<td>Decide to<br>reject $H_0$</td>\n<td style = \"border: 5px solid white; padding: 10px; color: white; background-color: red;\">Type I error <br>Alpha $\\alpha$ </td>\n<td style = \"border: 5px solid white; padding: 10px; color: black; background-color: lightgreen;\">Correct <br>True positive = Power</td>\n</tr>\n<tr height=\"150px\">\n<td>Decide not<br>to reject $H_0$</td>   \n<td style = \"border: 5px solid blue; padding: 10px; color: black; background-color: lightgreen;\">Correct <br> True negative</td>\n<td style = \"border: 5px solid white; padding: 10px; color: white; background-color: red;\">Type II error <br>Beta $\\beta$ </td>\n</tr>\n</table>\n\n\n* Correctly accept $H_0$\n* True negative\n\n::: {.cell}\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n## Beta {.subsection}\n\n<table style=\"border: none;  transform: scale(.5); float:right; margin: -70px;\">\n  <col width=\"150px\">\n  <col width=\"225px\">\n  <col width=\"225px\">\n<tr><td></td style=\"width: 300px;\"><td>$H_0$ = True</td style=\"width: 300px;\"><td>$H_0$ = False</td></tr>\n<tr height=\"150px\">\n<td>Decide to<br>reject $H_0$</td>\n<td style = \"border: 5px solid white; padding: 10px; color: white; background-color: red;\">Type I error <br>Alpha $\\alpha$ </td>\n<td style = \"border: 5px solid white; padding: 10px; color: black; background-color: lightgreen;\">Correct <br>True positive = Power</td>\n</tr>\n<tr height=\"150px\">\n<td>Decide not<br>to reject $H_0$</td>   \n<td style = \"border: 5px solid white; padding: 10px; color: black; background-color: lightgreen;\">Correct <br> True negative</td>\n<td style = \"border: 5px solid blue; padding: 10px; color: white; background-color: red;\">Type II error <br>Beta $\\beta$ </td>\n</tr>\n</table>\n\n* Incorrectly accept $H_0$\n* Type II error\n* False Negative\n* Criteria often 20%\n* Distribution depends on sample size\n\n\n::: {.cell}\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n## P-value {.subsection}\n\n> Conditional probability of the found test statistic or more extreme assuming the null hypothesis is true.\n\nReject $H_0$ when:\n\n* $p$-value <= $alpha$\n\n::: {.cell}\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n## Test statistics\n\nSome common test statistics\n\n* Number of heads\n* Sum of dice\n* Difference\n* $t$-statistic\n* $F$-statistic\n* $\\chi^2$-statistic\n* etc...\n\n## Decision Table {.flexbox .vcenter .smaller}\n\n::: {.cell}\n\n```{.r .cell-code}\nN     = 10  # Sample size\nH0    = .5  # Probability of head under H0 50/50\nHA    = .2  # Aternative expected value\nalpha = .05 # Selected type I error\n\n# Color areas red for selected alpha\narea <- dbinom(0:N, N, H0) < alpha/2\n\n# barplot(dbinom(0:N,N, HA)) -> x.values\n\n# x.values\n# lb <- x.values[c(qbinom(alpha/2, N+1, H0), qbinom(alpha/2, N+1, H0)+1 )]\n# ub <- x.values[c(qbinom(1-(alpha/2), N+1, H0), qbinom(1-(alpha/2), N+1, H0)+1 )]\n# \n# mlb <- mean(lb)\n# mub <- mean(ub)\n\ncol = rep(\"beige\", N+1)\ncol[area] = \"red\"\n\ncol2 = rep(\"red\", N+1)\ncol2[area] = \"beige\"\n\n# Delete # to not color the plots\n# col = col2  = \"beige\"\n\nlayout(matrix(1:9,3,3, byrow=T))\n\nplot.new()\ntext(0.5,0.5,\"Binomial Distribution\",cex=1.5)\n# text(0.5,0.1,paste(\"N:\",N),cex=1.5)\n\nplot.new()\ntext(0.5,0.5,\"H0 True\",cex=2)\n\nplot.new()\ntext(0.5,0.5,\"H0 False\",cex=2)\n\nplot.new()\ntext(0.5,0.5,\"Reject H0\",cex=2)\n\nbarplot(dbinom(0:N,N, H0), \n        col  = col, \n        # yaxt = 'n', \n        main = 'Alpha / Type I error', \n        names.arg = 0:N, \n        cex.names = 0.7)\n\n\n# abline(v = mlb, col=\"red\", lwd=3, lty=2)\n# abline(v = mub, col=\"red\", lwd=3, lty=2)\n\nbarplot(dbinom(0:N,N, HA), \n        col  = col, \n        yaxt = 'n', \n        main = 'Power', \n        names.arg = 0:N, \n        cex.names = 0.7)\n\nplot.new()\ntext(0.5,0.5,\"Accept H0\",cex=2)\n\nbarplot(dbinom(0:N,N, H0), \n        col  = col2, \n        # yaxt = 'n', \n        main = '1 - alpha', \n        names.arg = 0:N, \n        cex.names = 0.7)\n\nbarplot(dbinom(0:N,N, HA), \n        col  = col2, \n        yaxt = 'n', \n        main = 'Beta / Type II error', \n        names.arg = 0:N, \n        cex.names = 0.7)\n```\n\n\n\n----\n\n::: {.cell-output-display}\n![](nhst_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n## Reasoning Scheme {.subsection .flexbox .vcenter}\n\n![](../../../topics/NHST/NHST_descision_scheme.png)\n\n## R<-PSYCHOLOGIST {.smaller}\n\n<iframe style=\"height:450px;\" src=\"http://rpsychologist.com/d3/NHST/\"></iframe>\n\nSource: [Kristoffer Magnusson](http://rpsychologist.com/d3/NHST/)\n\n\n\n\n<!-- Footer insert below -->\n\n\n\n# End\n\n\n## Contact\n\n<script src=\"https://use.fontawesome.com/23c1d38eea.js\"></script>\n\n<ul class=\"fa-ul\" style=\"color:black; list-style:none;\">\n<li><i class=\"fa-li fa fa-twitter\"></i> <a href=\"https://twitter.com/shklinkenberg\" target=\"_blank\" style=\"color:black; border-bottom:none;\">@shklinkenberg</a></li>\n<li><i class=\"fa-li fa fa-linkedin-square\"></i> <a href=\"https://www.linkedin.com/in/sharonklinkenberg/\" target=\"_blank\" style=\"color:black; border-bottom:none;\">Klinkenberg</a></li>\n<li><i class=\"fa-li fa fa-envelope-o\"></i> <a style=\"unicode-bidi:bidi-override; direction: rtl; color:black\" href=\"javascript:window.location.href = 'mailto:' + ['s.klinkenberg','uva.nl'].join('@')\">ln.AvU@grebneknilK.S</a></li>\n<li><i class=\"fa-li fa fa-github\"></i> <a href=\"https://github.com/ShKlinkenberg\" target=\"_blank\" style=\"color:black; border-bottom:none;\">ShKlinkenberg</a></li>\n</ul>\n\n<small style=\"text-align:left;\">\n\n\n[![CC BY-NC-SA 4.0][cc-by-nc-sa-image]][cc-by-nc-sa]\n\n[cc-by-nc-sa]: http://creativecommons.org/licenses/by-nc-sa/4.0/\n[cc-by-nc-sa-image]: https://licensebuttons.net/l/by-nc-sa/4.0/88x31.png\n[cc-by-nc-sa-shield]: https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg\n\n</small>\n",
    "supporting": [
      "nhst_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}